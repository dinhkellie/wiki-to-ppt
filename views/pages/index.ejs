<!DOCTYPE html>
<html>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<style>

.reveal-if-active {
    opacity: 0;
    max-height: 0;
    overflow: hidden;
}

input[type="radio"]:checked ~ .reveal-if-active,
input[type="checkbox"]:checked ~ .reveal-if-active {
    opacity: 1;
    max-height: 100px; /* little bit of a magic number :( */
        overflow: visible;
    }

    form {
        /* Just to center the form on the page */
        margin: 0 auto;
        width: 500px;
        /* To see the outline of the form */
        padding: 1.4em;
        border: 3px solid;
        border-radius: 2em;
        text-align:center;
        margin-bottom: 25px;
        color:white;
        line-height:2;
    }

    img.display{
        width:80px;
        height: auto;
        display:block;
        margin-left:auto;
        margin-right:auto
    }

}
</style>
<link href='https://fonts.googleapis.com/css?family=Bungee+Shade|News+Cycle' rel='stylesheet'>

<h1 style="background-color:#FFFFFF;color:#4484CE;font-size=500%;text-align:center;font-family:'Bungee Shade';">
    Wikipedia to Powerpoint Generator
</h1>

<body style="background-color:#FFFFFF;font-family:'News Cycle';">
    <form style="background-color:#D9D9D9">
        What would you like to make a PowerPoint about today?  <br>
        <input type="text" size="30" placeholder="Search for topic...">
    </form>


    <form style="background-color:#F9CF00">
        What information would you like to include?<br>
        <input type="checkbox" name="gender" value="male" checked> Background
        <input type="checkbox" name="gender" value="female"> Notable Accomplishments <br>
        <input type="checkbox" name="gender" value="male" checked> Quotes
        <input type="checkbox" name="gender" value="female"> Images
    </form>


    <form style="background-color:#F19F4D">
        What style PowerPoint do you want? <br>
        <input type="radio" name="ppt-style" id="ppt-style-custom">
        <label for="ppt-style-default">Custom</label>
        <div class="reveal-if-active">
            <label>Color Scheme</label>
            <select>
                <option value="blue">Blue</option>
                <option value="pink">Pink</option>
                <option value="yellow">Yellow</option>
                <option value="green">Green</option>
            </select>
            <br>
            <label>Font</label>
            <select>
                <option value="arial">Arial</option>
                <option value="timesnewroman">Times New Roman</option>
                <option value="helvetica">Helvetica</option>
                <option value="georgia">Georgia</option>
            </select>
        </div>
        <input type="radio" name="ppt-style" id="ppt-style-default">
        <label for="ppt-style-default">Default</label>
    </form>

    <form method="get" action="/ppt" style="background-color:#4484CE">
        <button id="download" onclick="createPPT()" type="submit" name="download">Download!</button>
    </form>

    <script lang="javascript" src="pptxgenjs/libs/jquery.min.js"></script>
    <script lang="javascript" src="pptxgenjs/libs/jszip.min.js"></script>
    <script lang="javascript" src="pptxgenjs/dist/pptxgen.js"></script>
    <script>
    function createPPT() {
        var pptx = new PptxGenJS();
        console.log("here");

        //Presentation properties - Default
        pptx.setAuthor('Wikipedia to PowerPoint Generator');
        pptx.setTitle('Sample Presentation');

        pptx.setLayout('LAYOUT_WIDE');

        //Get from custom form on index page
        // var font = "Gothic";
        // var titleSize = 36;
        // var bodySize = 18;
        // var fontColor = '363636';
        // var background = '000000';

        // var title = "Example Presentation";


        var title = "<%= wiki_name %>";
        var color = pptcustom.cvalue;
        var font = pptcustom.tvalue;
        console.log(color);
        console.log(font);

        var slide = pptx.addNewSlide();
        //Slide 1
        slide.addText(title,
            {
                font_face:font, x:1.5, y:2.5, fontSize:60, color:color, align: 'ctr'
            });
            slide.addText("A sample presentation generated by Wikipedia to PPT",
            {
                fontSize:30, align: 'ctr', x:1.5, y:5.0
            });

            //Slide 2
            var slide2 = pptx.addNewSlide();
            slide2.addText("Key Facts",
            {
                x:1.0, y:1.0, fontSize:40, align: 'ctr'
            });
            slide2.addText("Born <%= birth_name %> in <%= birth_date %> in <%= birth_place %>",
            {
                x:1.0, y:2.5, fontSize:30, align: 'left', bullet:true
            });
            slide2.addText("Also goes by pseudonym <%= pseudonym %>",
            {
                x:1.0, y:4.0, fontSize:30, align: 'left', bullet:true
            });
            slide2.addText("Graduated from <%= education %>",
            {
                x:1.0, y:5.5, fontSize:30, align: 'left', bullet:true
            });

            //Slide 3
            var slide3 = pptx.addNewSlide();
            slide3.addText("Other Information",
            {
                x:1.0, y:1.0, fontSize:40, align: 'ctr'
            });
            slide3.addText("Occupation: <%= occupation %>",
            {
                x:1.0, y:2.5, fontSize:30, align: 'left', bullet:true
            });
            slide3.addText("<%= userTypedName %> is notable for <%= notable_for %>",
            {
                x:1.0, y:4.0, fontSize:30, align: 'left', bullet:true
            });
            slide3.addText("Their personal website is <%= website %>",
            {
                x:1.0, y:5.5, fontSize:30, align: 'left', bullet:true
            });

            pptx.save('Sample Presentation');
        }
        </script>
        <script src="scripts/formstuff.js" defer></script>
    </body>
    </html>
